---
import { Image } from 'astro:assets';
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import SEO from '../../components/SEO.astro';
import CTABox from '../../components/CTABox.astro';
import HeroBlog from '../../components/HeroBlog.astro';
import { formatDate, validateDate } from '../../utils/date';
import { calculateWordCount, estimateReadingTime } from '../../utils/wordCount';
import scanToEmailImg from '../../assets/images/blog/scan-to-email.webp';
import { posts } from '../../data/blog-posts';

// Get the post data from blog-posts.ts
const post = posts.find(p => p.slug === 'scan-to-email-printer');

const title = "Scan to Email on Your Office Printer with Microsoft 365 or Google Workspace";
const description = "Learn how to set up scan-to-email functionality on your office printer using Microsoft 365 or Google Workspace. A simple 5-minute guide.";
const date = post?.date || validateDate("2024-08-16"); // Use the date from blog-posts.ts, fallback to hardcoded date
const author = "Huntertech Team";
const category = "IT Support";
const keywords = ["scan to email", "printer setup", "Microsoft 365", "Google Workspace", "office printer", "document scanning"];

// Calculate word count from the article content
const wordCount = calculateWordCount(`
    If you've recently purchased a multi-function printer, or perhaps you want to finally set up scan to email on a soccer free Saturday, then this is the guide to help you do it in 5 minutes and stop pulling your hair out.

    Forget Trying to Read Through Super Technical Instructions
    Microsoft announced they are retiring the old school methods of app passwords and basic auth and all those things that hackers used to exploit their customers so they could scan to email. It was a bad idea anyway, so I applaud them for making it right. So what to do about all those annoying devices, software that wants to send alerts etc?

    Introducing SMTP2GO
    This wonderful service deserves your money even if you would never have a chance of exceeding their free email delivery tier. What you'll need to get started:
    - Your login for your domain registrar/DNS provider
    - A SMTP2GO account

    Setup Your Domain as a Verified Sender
    Sign into your new SMTP2GO account and on the left menu, expand Sending, and click Verified Senders. On the right side of the page, click Add Sender Domain. Type in your domain name (example.com for example).

    Take note of the next screen! These DNS records need to be entered into your DNS settings wherever your DNS records are located. Key information is the _type_ which are CNAME records, Hostname, and Value.

    Add in all 3 records. Click Verify on the SMTP2GO DNS screen. If it doesn't verify then you may have to wait up to 48hrs depending on your DNS provider. Good ones take a couple minutes.

    Create the SMTP User
    After you've been verified, hop on over to SMTP users on the left menu. Click Add SMTP User on the right side. Create the username and password (pick a strong one, or use their auto generated one). These will later be entered into your printer to setup SMTP.

    Configure Your Printer
    Every printer is a bit different here. In your email settings you'll likely have Authentication Method. This is going to be SMTP Auth.

    Username is going to match the username you created in the Add SMTP User step above (printer@yourdomain.com). The password will be the password from the above step.

    The right side of the SMTP2GO gives you the rest of the important details:
    - SMTP Server: mail.smtp2go.com
    - SMTP Port: 2525
    - Alternative/TLS Ports: 8025, 587, 80 or 25. TLS is available on the same ports.
    - SSL is available on ports: 465, 8465 and 443.

    Once you've entered those in you should be able to test the connection with your printer!
`);

const readingTime = estimateReadingTime(wordCount);

const structuredData = {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": title,
    "description": description,
    "image": {
        "@type": "ImageObject",
        "url": `https://huntertech.ca${scanToEmailImg.src}`,
        "width": "1200",
        "height": "630"
    },
    "author": {
        "@type": "Organization",
        "name": author,
        "url": "https://huntertech.ca"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Huntertech",
        "logo": {
            "@type": "ImageObject",
            "url": "https://huntertech.ca/images/huntertech-logo.png",
            "width": "600",
            "height": "60"
        }
    },
    "datePublished": date,
    "dateModified": date,
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://huntertech.ca/blog/scan-to-email-printer/"
    },
    "keywords": keywords,
    "articleSection": category,
    "inLanguage": "en-CA",
    "wordCount": wordCount.toString(),
    "isAccessibleForFree": true,
    "license": "https://creativecommons.org/licenses/by-nc-nd/4.0/",
    "timeRequired": `PT${readingTime}M`,
    "about": {
        "@type": "Thing",
        "name": "Printer Setup Guide",
        "description": "Complete guide to setting up scan to email functionality on business printers"
    },
    "mentions": [
        {
            "@type": "Thing",
            "name": "SMTP2GO",
            "description": "Email delivery service for business printers"
        },
        {
            "@type": "Thing",
            "name": "Microsoft Authentication",
            "description": "Modern authentication methods for business devices"
        },
        {
            "@type": "Thing",
            "name": "DNS Configuration",
            "description": "Domain name system setup for email services"
        }
    ]
};
---

<Layout title={title} description={description}>
    <SEO
        title={title}
        description={description}
        canonicalURL="https://huntertech.ca/blog/scan-to-email-printer/"
        keywords={keywords}
        type="article"
        image={scanToEmailImg.src}
        structuredData={structuredData}
    />
    
    <Header />
    
    <main class="blog-post">
        <HeroBlog 
            title={title}
            subtitle={`By ${author} • ${formatDate(date)} • ${readingTime} min read`}
            backgroundImage={scanToEmailImg}
            backgroundImageAlt="Scan to Email Printer Setup"
        />

        <div class="container">
            <div class="post-content">
                <div class="article-meta">
                    <span class="category">{category}</span>
                    <time datetime={date}>{formatDate(date)}</time>
                    <span class="reading-time">{readingTime} min read</span>
                </div>

                <p>If you've recently purchased a multi-function printer, or perhaps you want to finally set up scan to email on a soccer free Saturday, then this is the guide to help you do it in 5 minutes and stop pulling your hair out.</p>

                <h2>Forget Trying to Read Through Super Technical Instructions</h2>
                <p>Microsoft announced they are retiring the old school methods of app passwords and basic auth and all those things that hackers used to exploit their customers so they could scan to email. It was a bad idea anyway, so I applaud them for making it right. So what to do about all those annoying devices, software that wants to send alerts etc?</p>

                <h2>Introducing SMTP2GO</h2>
                <p>This wonderful service deserves your money even if you would never have a chance of exceeding their free email delivery tier. What you'll need to get started:</p>

                <ol>
                    <li>Your login for your domain registrar/DNS provider (not sure who you bought it from? You can search your domain up here: <a href="https://lookup.icann.org/" target="_blank" rel="noopener">ICANN Lookup</a> and then look for the registrar, 99% of websites use their registrar for DNS records).</li>
                    <li>A SMTP2GO account, sign up here: <a href="https://www.smtp2go.com/" target="_blank" rel="noopener">SMTP2GO: Reliable & Scalable Email Delivery Service</a> (The free tier is probably just fine for most)</li>
                </ol>

                <h2>Setup Your Domain as a Verified Sender</h2>
                <p>Sign into your new SMTP2GO account and on the left menu, expand Sending, and click Verified Senders. On the right side of the page, click Add Sender Domain. Type in your domain name (example.com for example).</p>

                <p>Take note of the next screen! These DNS records need to be entered into your DNS settings wherever your DNS records are located. Key information is the _type_ which are CNAME records, Hostname, and Value.</p>

                <p>Add in all 3 records. Click Verify on the SMTP2GO DNS screen. If it doesn't verify then you may have to wait up to 48hrs depending on your DNS provider. Good ones take a couple minutes.</p>

                <h2>Create the SMTP User</h2>
                <p>After you've been verified, hop on over to SMTP users on the left menu. Click Add SMTP User on the right side. Create the username and password (pick a strong one, or use their auto generated one). These will later be entered into your printer to setup SMTP.</p>

                <h2>Configure Your Printer</h2>
                <p>Every printer is a bit different here. In your email settings you'll likely have Authentication Method. This is going to be SMTP Auth.</p>

                <p>Username is going to match the username you created in the Add SMTP User step above (printer@yourdomain.com). The password will be the password from the above step.</p>

                <p>The right side of the SMTP2GO gives you the rest of the important details:</p>
                <ul>
                    <li>SMTP Server: <strong>mail.smtp2go.com</strong></li>
                    <li>SMTP Port: <strong>2525</strong></li>
                    <li>Alternative/TLS Ports: <strong>8025, 587, 80</strong> or <strong>25</strong>. TLS is available on the same ports.</li>
                    <li>SSL is available on ports: <strong>465, 8465</strong> and <strong>443</strong>.</li>
                </ul>

                <p>Once you've entered those in you should be able to test the connection with your printer!</p>

                <CTABox 
                    title="Need Help Setting Up Your Office Printer?"
                    description="Contact our team for expert assistance with printer configuration and office technology setup."
                    buttonText="Get Expert Help"
                    buttonLink="/contact/"
                />
            </div>
        </div>
    </main>
    <Footer />
</Layout>

<style>
    .blog-post {
        background: var(--bg-color);
    }

    .post-content {
        max-width: 800px;
        margin: 0 auto;
        padding: 0 20px 60px;
        line-height: 1.8;
    }

    .post-content h2 {
        color: var(--text-color);
        margin: 40px 0 20px;
        font-size: 1.8em;
    }

    .post-content p {
        margin-bottom: 20px;
    }

    .post-content ol, .post-content ul {
        margin-bottom: 20px;
        padding-left: 20px;
    }

    .post-content li {
        margin-bottom: 10px;
    }

    .post-content a {
        color: var(--button-color);
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .post-content a:hover {
        color: var(--primary-color);
    }

    @media (max-width: 768px) {
        .post-content {
            padding: 0 15px 40px;
        }
    }

    .reading-time {
        color: var(--text-muted);
        font-size: 0.9rem;
    }
</style> 