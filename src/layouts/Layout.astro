---
interface Props {
    title: string;
    description?: string;
    image?: string;
}

const {
    title,
    description = "Huntertech - Professional IT Solutions & Revit Management Services",
    image = "/images/Huntertech_logo.png"
} = Astro.props;

// Generate a cryptographically secure nonce (32 bytes = 256 bits)
const nonce = crypto.getRandomValues(new Uint8Array(32))
    .reduce((acc, val) => acc + val.toString(16).padStart(2, '0'), '');

import Favicons from '../components/Favicons.astro';
---

<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Content Security Policy -->
        <meta http-equiv="Content-Security-Policy" content={`
            default-src 'self';
            script-src 'self' 'nonce-${nonce}' 'unsafe-hashes' https://www.googletagmanager.com https://embed.tawk.to;
            style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
            font-src 'self' https://fonts.gstatic.com;
            img-src 'self' data: https:;
            connect-src 'self' https://www.google-analytics.com https://stats.g.doubleclick.net;
            frame-src 'self' https://www.google.com;
            base-uri 'self';
            form-action 'self';
        `.replace(/\s+/g, ' ').trim()} />

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-07H6TWB4QD" nonce={nonce}></script>
        <script nonce={nonce}>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-07H6TWB4QD');
        </script>

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        
        <!-- Favicons -->
        <Favicons />
        
        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link 
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap&text=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.,!?@#$%&*()_+-=[]{}|;:'%22/%3C%3E" 
            rel="stylesheet"
            media="print"
            onload="this.media='all'"
        />
        <noscript>
            <link 
                href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap&text=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.,!?@#$%&*()_+-=[]{}|;:'%22/%3C%3E" 
                rel="stylesheet"
            />
        </noscript>
        <link rel="sitemap" href="/sitemap-index.xml" />
        
        <!-- Structured Data -->
        <script type="application/ld+json" nonce={nonce}>
            {JSON.stringify({
                "@context": "https://schema.org",
                "@type": "Organization",
                "name": "Huntertech",
                "url": "https://www.huntertech.ca",
                "logo": "https://www.huntertech.ca/images/logo.png",
                "description": "Professional IT solutions and Revit management services for businesses in Calgary and Vancouver",
                "areaServed": [
                    {
                        "@type": "City",
                        "name": "Calgary",
                        "address": {
                            "@type": "PostalAddress",
                            "addressRegion": "AB",
                            "addressCountry": "CA"
                        }
                    },
                    {
                        "@type": "City",
                        "name": "Vancouver",
                        "address": {
                            "@type": "PostalAddress",
                            "addressRegion": "BC",
                            "addressCountry": "CA"
                        }
                    }
                ],
                "contactPoint": [
                    {
                        "@type": "ContactPoint",
                        "telephone": "+1-825-415-6990",
                        "contactType": "customer service",
                        "areaServed": "CA-AB",
                        "availableLanguage": ["English"]
                    },
                    {
                        "@type": "ContactPoint",
                        "telephone": "+1-778-819-7411",
                        "contactType": "customer service",
                        "areaServed": "CA-BC",
                        "availableLanguage": ["English"]
                    }
                ],
                "sameAs": [
                    "https://www.linkedin.com/company/huntertech",
                    "https://www.facebook.com/huntertech"
                ]
            })}
        </script>
        
        <script type="application/ld+json" nonce={nonce}>
            {JSON.stringify({
                "@context": "https://schema.org",
                "@type": "Service",
                "name": "Huntertech",
                "image": "https://www.huntertech.ca/images/Huntertech_logo.png",
                "areaServed": [
                    {
                        "@type": "City",
                        "name": "Calgary",
                        "address": {
                            "@type": "PostalAddress",
                            "addressRegion": "AB",
                            "addressCountry": "CA"
                        }
                    },
                    {
                        "@type": "City",
                        "name": "Vancouver",
                        "address": {
                            "@type": "PostalAddress",
                            "addressRegion": "BC",
                            "addressCountry": "CA"
                        }
                    }
                ]
            })}
        </script>
        
        <script type="application/ld+json" nonce={nonce}>
            {JSON.stringify({
                "@context": "https://schema.org",
                "@type": "WebSite",
                "name": "Huntertech",
                "url": "https://www.huntertech.ca"
            })}
        </script>

        <!--Start of Tawk.to Script-->
        <script type="text/javascript" nonce={nonce}>
            var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
            (function(){
            var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
            s1.async=true;
            s1.src='https://embed.tawk.to/682b6ac09c94e2190d83dfb7/1irkpi0h8';
            s1.charset='UTF-8';
            s1.setAttribute('crossorigin','*');
            s1.setAttribute('nonce',nonce);
            s0.parentNode.insertBefore(s1,s0);
            })();
        </script>
        <!--End of Tawk.to Script-->
    </head>
    <body>
        <slot />
    </body>
</html>

<style is:global>
    /* Import global styles */
    @import '../styles/global.css';

    /* Layout-specific styles */
    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        line-height: 1.6;
    }
</style> 